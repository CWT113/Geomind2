# 类型标注

## 为 props 标注类型

`defineProps()` 宏函数支持从它的参数中进行类型推导。

::: code-group

```vue [运行时声明]
<template>
  <div>{{ msg }}</div>
</template>

<script setup lang="ts">
const props = defineProps({
  msg: {
    type: String,
    required: false,
    default: "Hello",
  },
  age: Number
})
</script>
```

```vue [类型式声明]
<template>
  <div>{{ msg }}</div>
</template>

<script setup lang="ts">
const props = defineProps<{
  msg: string,
  age?: number
}>();
</script>
```

```vue [类型式声明解构赋值] {11}
<template>
  <div>{{ msg }} -- {{ age }}</div>
</template>

<script setup lang="ts">
interface props {
  msg: string,
  age?: number
}

const { msg = "hello", age = 25 } = defineProps<props>()
</script>
```

:::



## 为 emits 标注类型

在 `<script setup>` 中，`emit` 函数的类型标注也可以通过运行时声明或是类型声明进行。

```vue
<script setup lang="ts">
// 运行时
const emit = defineEmits(['change', 'update'])

// 基于选项
const emit = defineEmits({
  change: (id: number) => {
    // 返回 `true` 或 `false`
    // 表明验证通过或失败
  },
  update: (value: string) => {
    // 返回 `true` 或 `false`
    // 表明验证通过或失败
  }
})

// 基于类型
const emit = defineEmits<{
  (e: 'change', id: number): void
  (e: 'update', value: string): void
}>()

// 3.3+: 可选的、更简洁的语法
const emit = defineEmits<{
  change: [id: number]
  update: [value: string]
}>()
</script>
```



## 为 reactive 标注类型

`reactive()` 也会隐式地从它的参数中推导类型：

```vue
<script setup lang="ts">
import { reactive } from "vue";

// const title: { title: string }
const title = reactive({
  title: "Hello World",
})
</script>
```

要显式地标注一个 `reactive` 变量的类型，我们可以使用接口：

```vue
<script setup lang="ts">
import { reactive, ref } from "vue";

interface User {
  name: string;
  age: number;
}

// ✔️推荐
const user: User = reactive({
  name: "tom",
  age: 25
})

// ❌不推荐
const user = reactive<User>({
  name: "tom",
  age: 25
})
</script>
```

> [!TIP] 建议
>
> 不推荐使用 `reactive()` 的泛型参数，因为处理了深层次 ref 解包的返回值与泛型参数的类型不同。



## 为 computed 标注类型

`computed()` 会自动从其计算函数的返回值上推导出类型：

```vue {6}
<script setup lang="ts">
import { computed, ref } from "vue";

const count = ref(2);

const double = computed<number>(() => count.value * 2);
</script>
```



## 为模板引用标注类型

在 Vue 3.5 以后，通过 `useTemplateRef()` 可以直接获取 `<template>` 模板中使用 `ref` 声明的 dom 元素。

```vue {9}
<template>
  <div ref="divRef"></div>
</template>

<script setup lang="ts">
import { ref, useTemplateRef } from "vue";

// Vue3.5 之后
const divRef = useTemplateRef<HTMLDivElement>("divRef");

// Vue3.5 之前
const divRef2 = ref<HTMLDivElement | null>(null);
</script>
```